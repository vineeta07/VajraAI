services:
  # Backend Service (Node.js/Express)
  - type: web
    name: hack4delhi-server
    runtime: node
    repo: https://github.com/vineeta07/Hack4Delhi
    plan: free
    rootDir: server
    buildCommand: npm install
    startCommand: node db/dbSetup.js && npm start
    envVars:
      - key: PORT
        value: 10000
      - key: DATABASE_CONNECTION_STRING
        fromDatabase:
          name: hack4delhi-db
          property: connectionString
      - key: JWT_SECRET
        generateValue: true
      - key: JWT_EXPIRES_IN
        value: 24h
      - key: ML_SERVICE_URL
        fromService:
          type: web
          name: hack4delhi-ml-service
          property: url
          envVarKey: ML_SERVICE_URL

  # ML Service (Python/FastAPI)
  - type: web
    name: hack4delhi-ml-service
    runtime: python
    repo: https://github.com/vineeta07/Hack4Delhi
    plan: free
    rootDir: ml-service
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn ml_transformer_service:app --host 0.0.0.0 --port 10000
    envVars:
      - key: PORT
        value: 10000

databases:
  - name: hack4delhi-db
    plan: free
    databaseName: hack4delhi
    user: hack4delhi_user

# Note: For Vercel deployment of the client, you will need to set:
# VITE_API_URL = https://hack4delhi-server.onrender.com (the URL of the backend service above)
